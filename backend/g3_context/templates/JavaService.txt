package com.ingenio.backend.module.${moduleName}.service;

import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
import com.ingenio.backend.module.${moduleName}.entity.${EntityName};
import com.ingenio.backend.module.${moduleName}.mapper.${EntityName}Mapper;
import com.ingenio.backend.module.${moduleName}.dto.${EntityName}DTO;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;
import org.springframework.beans.BeanUtils;

/**
 * ${EntityName} 业务逻辑层
 * Generated by Ingenio G3 (Player Agent)
 */
@Slf4j
@Service
@RequiredArgsConstructor
public class ${EntityName}Service extends ServiceImpl<${EntityName}Mapper, ${EntityName}> {

    // 可以在这里注入其他服务的依赖，如用户服务、通知服务等
    // private final NotificationService notificationService;

    @Transactional(rollbackFor = Exception.class)
    public void create(${EntityName}DTO dto) {
        log.info("Creating ${EntityName}: {}", dto);
        ${EntityName} entity = new ${EntityName}();
        BeanUtils.copyProperties(dto, entity);
        
        // TODO: G3 Agent - 在此处填充具体的业务校验逻辑 (Business Logic Slot)
        
        this.save(entity);
        log.info("${EntityName} created with ID: {}", entity.getId());
    }

    @Transactional(rollbackFor = Exception.class)
    public void update(String id, ${EntityName}DTO dto) {
        log.info("Updating ${EntityName} ID: {}", id);
        ${EntityName} entity = this.getById(id);
        if (entity == null) {
            throw new RuntimeException("${EntityName} not found");
        }
        BeanUtils.copyProperties(dto, entity);
        
        // TODO: G3 Agent - 在此处填充更新权限校验 (Permission Check Slot)
        
        this.updateById(entity);
    }
}
